# 鍵・宝箱・出口ドア仕様（通常版）

> **目的** : ゲームの基本サイクル「鍵を取り → 扉を開け → 次の迷路へ」を、だれでもイメージできるようにまとめる。実装コードは載せず、振る舞いと見た目を中心に記述。

---

## 1. 登場オブジェクト

| オブジェクト | 役割 | ビジュアル例 | 生成数 / チャンク |
|--------------|------|-------------|-----------------|
| **通常宝箱** | 鍵を入れている。プレイヤーが同じタイルに移動すると開き、鍵を即取得。箱は消滅。 | ゴールド＋王冠モチーフ | 必ず1個 |
| **鍵 (インベントリ)** | 宝箱を開いた瞬間に自動取得され、キャラクター頭上のアイコンに加算。 | 鍵アイコン 🔑 | 上限なし |
| **出口ドア（閉）** | 鍵を持った状態で触れると開く。 | 扉＋錠前付き 🚪 | 必ず1個（外周） |
| **出口ドア（開）** | 通過判定のみ。通過時にスコアが加算され、新チャンクが生成。 | 扉が光る🚪✨ | — |

---

## 2. フローまとめ

1. **宝箱接触**  
   - 上方向から触れた瞬間に「カパッ」と開くアニメ。  
   - プレイヤーは **即座に鍵を取得**。  
   - 宝箱スプライトは 0.2 秒でフェードアウトして消滅。
2. **鍵取得演出**
   - プレイヤーの頭の上に **鍵アイコン🔑を 1 秒間フワッと表示**。
   - 以降、所持数に応じて頭上アイコンが常時表示される。
3. **扉接触（鍵所持）**  
   - 扉が開くアニメ＋光エフェクト。  
   - 所持鍵を 1 つ消費。  
   - スコア +100。  
   - イベント「door‑open」が発火し、新チャンク生成＆カメラパン。
4. **扉接触（鍵なし）**  
   - ノック SE と小さな振動だけで開かない。

---

## 3. 視覚 & 音のガイドライン

| 状態                | 画面フィードバック | SE / BGM 変化 |
|-------------------|----------------|--------------|
| 宝箱開く            | 蓋が跳ねる＋金色の火花 | 「カチャン」短い開錠音 |
| 鍵アイコン頭上表示       | 透明→実体→透明のフェード（1 s） | 「チャリーン」きらめき音 |
| 扉開く（成功）         | 扉が左右に開き光が漏れる    | 「ゴゴゴ…」低めの金属音 ＋BGMコード上昇 |
| 扉触れ（鍵なし）        | 扉小揺れ・赤いバツ印 0.3 s | 「ガン」鈍いロック音 |

---

## 4. エッジケース

| ケース              | 振る舞い |
|-------------------|--------|
| 鍵を複数所持したまま扉を開く | 鍵は 1 つだけ消費。残りは次チャンクへ持ち越し。 |

---

## 5. HUD 連動

- **鍵アイコン** : 廃止。鍵の所持数はプレイヤー頭上に表示される。
- **スコアテキスト** : 扉通過時にポップアップ数値が上昇アニメ。

---

## 6. 用語ミニ辞典

| 用語  | 意味 | メモ |
|------|------|------|
| 宝箱 (Chest) | 鍵やアイテムを入れた箱 | 上から開けることで獲得 |
| 出口ドア (Gate) | 次チャンクへの出口 | 鍵が必要 |
| HUD | 画面固定の情報表示 | スコア・鍵数など |

---

© 2025 Dainei Makino. 本資料はプロジェクトメンバー・教育目的での転載を許可します。

